apiVersion: rabbitmq.com/v1beta1
kind: RabbitmqCluster
metadata:
  name: rabbitmq-cluster
  namespace: {{cookiecutter.namespace}}
  labels:
    app: celery
spec:
  override:
    statefulSet:
      spec:
        template:
          spec:
            {% if cookiecutter.airflow_performance == 'micro' -%}
            nodeSelector:
              "purpose": {{cookiecutter._nodeSelectorPurposeWebserver}}
            {% elif cookiecutter.airflow_performance == 'small' -%}
            nodeSelector:
              "purpose": {{cookiecutter._nodeSelectorPurposeWebserver}}
            {% else -%}
            nodeSelector:
              "purpose": {{cookiecutter._nodeSelectorPurposeWebserver}}
            {%- endif %}
            containers: []
            securityContext: {}
  replicas: 1
  resources:
    requests:
      memory: "1Gi"
      cpu: "1"
    limits:
      memory: "3.7Gi"
      cpu: "1.5"
  rabbitmq:
          additionalConfig: |
                  default_user = admin 
                  default_pass = admin
                  default_user_tags.administrator = true
